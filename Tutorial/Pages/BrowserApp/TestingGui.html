<!-- HTML fragment for the text of this tutorial page -->

<div class="tutorialTitle">Testing - Unit</div>
<div class="tutorialText">
	All SmallJS GUI (client) example apps have automated GUI testing that can be copied and customised.<br>
	Web (browser) apps have automated testing for browsers: Chrome, Edge and Firefox.<br>
	Automated testing can be started from VSCode by selecting the desired configuration.<br>
	The script <code>build.sh</code> also runs unit and GUI tests after building.<br>
</div>

<div class="tutorialHeading1">GUI tests class</div>
<div class="tutorialText">
	...CONTINUE HERE...
	Let's start by unit tests for our class <code>Frequencies</code>.<br>
	In the folder <code>./src/Test</code>, rename the file <code>TestCounter.stx</code> to <code>TestFrequencies.st</code>,<br>
	to get it back into the ST build.<br>
	<br>
	Replace its file contents with the  following:
<pre clas="codeBlock">
CLASS TestFrequencies EXTENDS Test MODULE TestFrequenciesApp
	CLASSVARS '' VARS ''

test
	| frequencies dictionary keyValue |
	frequencies := Frequencies new.
	frequencies calculate: 'abb'.

	dictionary := frequencies letterDictionary.
	self assert: [ dictionary size = 2 ].
	self assert: [ ( dictionary at: $a ) = 1 ].

	keyValue := dictionary keyValues first.
	self assert: [ keyValue key = $b ].
	self assert: [ keyValue value = 2 ].
!
</pre>
	<br>
	On screen it should look like this:
	<img src="TestingUnit.png" class="screenPart"><br>
	We'll to through it piece by piece below.
</div>

<div class="tutorialHeading2">Class definition</div>
<div class="tutorialText">
	This is the class definition:<br>
	<img src="TestingUnitClassDefinition.png" class="screenPart"><br>
	By convention, the class name starts with the word 'Test'.<br>
	Unit tests classes must inherit from the base class <code>Test</code>, to enable automatic discovery.<br>
	The module name is also prefixed with 'Test',<br>
	so they don't abscure the main code and can be removed when deploying.<br>
	There are no class and instance varables here, but they can be useful in complex tests.<br>
</div>

<div class="tutorialHeading2">Test method header</div>
<div class="tutorialText">
	This is the header and first few lines of the (first) test method:<br>
	<img src="TestingUnitMethodHeader.png" class="screenPart"><br>
	In classes dirived from <code>Test</code>,<br>
	methods whose name start with <code>test</code> are autoamtically called by the unit tester.<br>
	So you can move more methods <code>testA</code>, <code>testB</code> to group tests.<br>
	And methods names not starting with <code>test</code> are utility methods that can be called.<br>
	E.g. an event handler triggered by the method <code>testA</code>> could be called <code>onTestA</code><br>
	<br>
	The next lines delare some local variables, create a new <code>Frequencies</code> object,<br>
	and calculate some results with the test string <code>'abb'</code> want to check.<br>
</div>

<div class="tutorialHeading2">Test assertions</div>
<div class="tutorialText">
	The second part of the <code>test</code> method actually performs the tests.<br>
	<img src="TestingUnitAssert.png" class="screenPart"><br>
	The letter disctionary should contain 2 entries.<br>
	It should contain frequency 1 at letter 'a'.<br>
	The first key / value in the sorted letter frequencies should key 'b' and value 2.<br>
</div>

<div class="tutorialHeading2">Calling tests</div>
<div class="tutorialText">
	To run this test code we have to call unit tests somewhere.<br>
	In the file <code>./src/Frequencies</code> replace the <code>start</code> method with de following code:<br>
	(Adding a third line calling <code>TestFrequencies all</code>)
<pre class="codeBlock">
start
	frequencies := Frequencies new.
	self bindElements.
	TestFrequencies all.
!
</pre>

<div class="tutorialHeading2">Running tests</div>
<div class="tutorialText">
	Now close and start the app again in VSCode with [F5].<br>
	After switching back to VSCode, form the browser,<br>
	the tab 'DEBUG CONSOLE' in the bottom pane should look like this:<br>
	<img src="TestingUnitRun.png" class="screenPart"><br>

	Now on to testing the GUI...
</div>
